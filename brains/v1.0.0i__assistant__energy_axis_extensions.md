# v1.0.0i — High-energy axis support

## Context
- Goal: broaden ASCII ingestion and canonical conversions to handle keV/MeV energy units and petahertz
  frequency labels encountered in new exports.
- Debugging need: provenance did not distinguish whether the axis was interpreted as frequency or energy,
  slowing down investigations of user uploads.

## Changes
- Added nm↔frequency_phz and nm↔energy_{keV,MeV} conversions, wiring the new units through canonicalisation
  and ingestion hints so the loader recognises high-energy spectra.
- Classified axis families during ASCII ingest, surfacing the result in provenance and extending tests to
  cover keV/MeV/PHz data, including round-trip checks in the transforms module.
- Updated atlas/docs, patch notes, handoff, and version metadata to advertise `1.0.0i` /
  `1.0.0.dev9` with the new unit coverage.

## Decisions
- Reused the existing alias/unit-hint pipeline for detection, layering classification logic rather than
  introducing a separate parsing stage to keep heuristics deterministic.
- Defaulted axis family to `wavelength` when no energy/frequency markers are present so provenance remains
  informative even for minimally labelled uploads.
- Recorded the new unit support in docs/continuity artifacts immediately to maintain the immutable audit
  trail expected by the project.

## Tests & Evidence
- `python -m pip install -e .`
- `ruff check .`
- `black --check .`
- `mypy .`
- `PYTHONPATH=. pytest -q`
- `python tools/verifiers/Verify-Atlas.py`
- `python tools/verifiers/Verify-PatchNotes.py`
- `python tools/verifiers/Verify-Handoff.py`
- `python tools/verifiers/Verify-Brains.py`
- `PYTHONPATH=. python tools/verifiers/Verify-UI-Contract.py`

## Regressions Prevented
- Ensures keV/MeV energy exports convert correctly to the wavelength baseline instead of failing unit
  detection or producing invalid nm values.
- Allows petahertz-labelled spectra to ingest alongside lower-frequency data, preserving overlay fidelity.
- Provides clear provenance breadcrumbs when diagnosing why an axis was treated as frequency or energy.

## Follow-ups
- Surface the axis family in the UI (e.g., provenance sidebar) for faster human debugging.
- Extend coverage to smaller energy units (meV) or additional frequency aliases if future datasets demand it.
- Continue archive fetcher build-out so high-energy spectra can be exercised end-to-end.

## Checklist
- [x] Atlas updated (`atlas/ingest_ascii.md`, `atlas/transforms.md`)
- [x] Patch notes & handoff updated (`PATCH_NOTES_v1.0.0(i).md`, `HANDOFF_v1.0.0(i).md`)
- [x] Tests added/updated (`tests/test_ascii_loader.py`, `tests/test_transforms.py`, `tests/test_canonicalize.py`)
